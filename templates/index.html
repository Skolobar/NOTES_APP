{% extends "base.html" %}

{% block content %}

<form method="POST" id="addForm" class="add-form">
    <textarea id="noteText" name="text" placeholder="Upi≈°i novu napomenu..." required></textarea>
    <button type="submit">Spremi</button>
</form>

<ul class="notes">
    {% for note in notes %}
        <li class="{% if note.pinned %}pinned{% endif %}">
            <p>{{ note.text }}</p>

            <small class="timestamp">
                {{ note.created_at[:16].replace('T', ' ') }}
            </small>

            <div class="actions">
                <form method="POST" action="{{ url_for('toggle_pin', note_id=note.id) }}">
                    <button type="submit" class="pin">
                        {% if note.pinned %}üìå Otkvaƒçi{% else %}üìç Pin{% endif %}
                    </button>
                </form>

                <a href="{{ url_for('edit', note_id=note.id) }}">Uredi</a>

                <form method="POST"
                      action="{{ url_for('delete', note_id=note.id) }}"
                      onsubmit="return confirm('Da li ste sigurni da ≈æelite obrisati napomenu?');">
                    <button type="submit" class="delete">Obri≈°i</button>
                </form>
            </div>
        </li>
    {% else %}
        <li class="empty">Nema napomena.</li>
    {% endfor %}
</ul>

{% endblock %}
<script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
<script>
  const SUPABASE_URL = "https://XXXX.supabase.co";
  const SUPABASE_ANON_KEY = "XXXX";

  const supabaseClient = supabase.createClient(

    SUPABASE_URL,
    SUPABASE_ANON_KEY
  );
</script>
<script>
  async function testLogin() {
    const { data, error } = await supabase.auth.signInWithPassword({
      email: "test@test.com",
      password: "123456"
    });

    if (error) {
      console.error("LOGIN ERROR:", error.message);
    } else {
      console.log("LOGIN OK:", data.user.email);
    }
  }

  testLogin();
</script>

