{% extends "base.html" %}

{% block content %}

<div id="app" style="display:none;">

    <form id="addForm" class="add-form">
        <textarea id="noteText" placeholder="UpiÅ¡i novu napomenu..." required></textarea>
        <button type="submit">Spremi</button>
    </form>

    <ul class="notes" id="notesList">
        <li class="empty">Nema napomena.</li>
    </ul>

</div>

<div id="notLoggedIn" style="display:none; text-align:center; margin-top:40px;">
    <p>Niste prijavljeni.</p>
    <a href="/login">Idi na login</a>
</div>

{% endblock %}

{% block scripts %}
<script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>

<script>
const SUPABASE_URL = "https://XXXX.supabase.co";
const SUPABASE_ANON_KEY = "XXXX";

const supabaseClient = supabase.createClient(
    SUPABASE_URL,
    SUPABASE_ANON_KEY
);

const appEl = document.getElementById("app");
const notLoggedInEl = document.getElementById("notLoggedIn");

async function init() {
    const { data } = await supabaseClient.auth.getUser();

    if (!data.user) {
        appEl.style.display = "none";
        notLoggedInEl.style.display = "block";
        return;
    }

    // user je logiran
    appEl.style.display = "block";
    notLoggedInEl.style.display = "none";
}

init();
</script>

{% endblock %}
