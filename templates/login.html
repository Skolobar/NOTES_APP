{% extends "base.html" %}

{% block content %}
<h2>Prijava</h2>

<form onsubmit="login(event)" class="login-form">
    <input type="email" id="email" placeholder="Email" required>
    <input type="password" id="password" placeholder="Lozinka" required>
    <button type="submit">Uđi</button>
</form>

<p id="error" style="color:red;"></p>
{% endblock %}

{% block scripts %}
<script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>

<script>
const SUPABASE_URL = "https://XXXX.supabase.co";
const SUPABASE_ANON_KEY = "XXXX";

const supabaseClient = supabase.createClient(
    SUPABASE_URL,
    SUPABASE_ANON_KEY
);

async function login(e) {
    e.preventDefault();

    const email = document.getElementById("email").value;
    const password = document.getElementById("password").value;
    const errorEl = document.getElementById("error");

    const { data, error } = await supabaseClient.auth.signInWithPassword({
        email,
        password
    });

    if (error) {
        errorEl.textContent = error.message;
        return;
    }

    // login OK → idi na notes
    window.location.href = "/";
}
</script>
{% endblock %}
